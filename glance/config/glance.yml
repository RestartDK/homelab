server:
  proxied: true
auth:
  secret-key: ${GLANCE_SECRET}
  users:
    daniel:
      password: ${GLANCE_DANIEL_PASSWORD}
theme:
  disable-picker: false
  presets:
    kanso-zen:
      background-color: 210 36 5 
      primary-color: 150 4 78 
      positive-color: 91 13 54 
      negative-color: 353 70 65 
      accent-color: 199 19 62 
    
    kanso-pearl:
      light: true
      background-color: 40 10 94 
      primary-color: 218 14 15 
      positive-color: 86 27 42 
      negative-color: 352 55 52 
      accent-color: 218 34 45 
pages:
  - name: Home
    columns:
      - size: small
        widgets:
          - type: clock
            hour-format: 24h
            timezones:
              - timezone: Europe/Madrid
                label: Madrid
              - timezone: America/New_York
                label: Boston
          - type: calendar
            first-day-of-week: monday
          - type: weather
            location: Madrid, Spain
            units: metric
            hour-format: 24h 

      - size: full
        widgets:
          - type: group
            widgets:
              - type: hacker-news
              - type: lobsters

          - type: videos
            channels:
              - UCbRP3c757lWg9M-U7TyEkXA # Theo browne
              - UCcefcZRL2oaA_uBNeo5UOWg # Y combinator
              - UCsBjURrPoezykLs9EqgamOA # Fireship
              - UCBJycsmduvYEL83R_U4JriQ # Marques Brownlee

          - type: rss
            limit: 10
            collapse-after: 3
            cache: 12h
            feeds:
              - url: https://selfh.st/rss/
                title: selfh.st
                limit: 4
              - url: https://ciechanow.ski/atom.xml
              - url: https://www.joshwcomeau.com/rss.xml
                title: Josh Comeau
              - url: https://samwho.dev/rss.xml
              - url: https://ishadeed.com/feed.xml
                title: Ahmad Shadeed

      - size: small
        widgets:
          - type: repository
            repository: RestartDK/homelab
            pull-requests-limit: 5
            issues-limit: 3
            commits-limit: 3

  - name: Admin
    columns:
      - size: small
        widgets:
          - type: dns-stats
            service: adguard
            url: https://adguard.chateauducipieres.com
            username: ${ADGUARD_USERNAME}
            password: ${ADGUARD_PASSWORD}
          - type: server-stats
            servers:
              - type: local
                name: "srv-hatchi"
                hide-mountpoints-by-default: true
                mountpoints:
                  "/":
                    hide: false
              - type: remote
                name: "srv-nana"
                url: http://${OLLAMA_HOST}:8080
      - size: full
        widgets:
          - type: monitor
            cache: 1m
            title: Services
            sites:
              - title: Jellyfin
                url: https://jellyfin.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/jellyfin.svg
              - title: Portainer
                url: https://portainer.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/portainer.svg
              - title: Jellyseerr
                url: https://jellyseerr.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/jellyseerr.svg
              - title: Komga
                url: https://komga.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/komga.svg
              - title: Nextcloud
                url: https://nextcloud.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/nextcloud.svg
              - title: Radarr
                url: https://radarr.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/radarr.svg
              - title: Sonarr
                url: https://sonarr.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/sonarr.svg
              - title: Qbittorrent
                url: https://qbittorrent.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/qbittorrent.svg
              - title: Suwayomi
                url: https://suwayomi.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/suwayomi.svg
              - title: Cockpit
                url: https://admin.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/cockpit.svg
              - title: Prowlarr
                url: https://prowlarr.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/prowlarr.svg
              - title: AdGuard Home
                url: https://adguard.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/adguard-home.svg
              - title: Dokploy
                url: https://dokploy.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/dokploy.svg
              - title: Ollama
                url: https://ollama.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/ollama.svg
              - title: CouchDB
                url: https://couchdb.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/couchdb.svg
              - title: Grafana
                url: https://grafana.${DOMAIN}
                icon: https://cdn.jsdelivr.net/gh/homarr-labs/dashboard-icons/svg/grafana.svg

      - size: small
        widgets:
          - type: custom-api
            title: Tailscale Devices
            title-url: https://login.tailscale.com/admin/machines
            url: https://api.tailscale.com/api/v2/tailnet/-/devices
            headers:
              Authorization: Bearer ${TAILSCALE_API_KEY}
            cache: 10m
            template: |
              {{/* User Variables */}}
              {{/* Set to true if you'd like an indicator for online devices */}}
              {{ $enableOnlineIndicator := true }}

              <style>
                .device-info-container {
                  position: relative;
                  overflow: hidden;
                  height: 1.5em;
                }

                .device-info {
                  display: flex;
                  transition: transform 0.2s ease, opacity 0.2s ease;
                }

                .device-ip {
                  position: absolute;
                  top: 0;
                  left: 0;
                  transform: translateY(-100%);
                  opacity: 0;
                  transition: transform 0.2s ease, opacity 0.2s ease;
                }

                .device-info-container:hover .device-info {
                  transform: translateY(100%);
                  opacity: 0;
                }

                .device-info-container:hover .device-ip {
                  transform: translateY(0);
                  opacity: 1;
                }

                .update-indicator {
                  width: 8px;
                  height: 8px;
                  border-radius: 50%;
                  background-color: var(--color-primary);
                  display: inline-block;
                  margin-left: 4px;
                  vertical-align: middle;
                }

                .offline-indicator {
                  width: 8px;
                  height: 8px;
                  border-radius: 50%;
                  background-color: var(--color-negative);
                  display: inline-block;
                  margin-left: 4px;
                  vertical-align: middle;
                }

                .online-indicator {
                  width: 8px;
                  height: 8px;
                  border-radius: 50%;
                  background-color: var(--color-positive);
                  display: inline-block;
                  margin-left: 4px;
                  vertical-align: middle;
                }

                .device-name-container {
                  display: flex;
                  align-items: center;
                  gap: 8px;
                }

                .indicators-container {
                  display: flex;
                  align-items: center;
                  gap: 4px;
                }
              </style>
              <ul class="list list-gap-10 collapsible-container" data-collapse-after="4">
                {{ range .JSON.Array "devices" }}
                <li>
                  <div class="flex items-center gap-10">
                    <div class="device-name-container grow">
                      <span class="size-h4 block text-truncate color-primary">
                        {{ findMatch "^([^.]+)" (.String "name") }}
                      </span>
                      <div class="indicators-container">
                        {{ if (.Bool "updateAvailable") }}
                        <span class="update-indicator" data-popover-type="text" data-popover-text="Update Available"></span>
                        {{ end }}

                        {{ $lastSeen := .String "lastSeen" | parseTime "rfc3339" }}
                        {{ if not ($lastSeen.After (offsetNow "-10s")) }}
                        {{ $lastSeenTimezoned := $lastSeen.In now.Location }}
                        <span class="offline-indicator" data-popover-type="text"
                          data-popover-text="Offline - Last seen {{ $lastSeenTimezoned.Format " Jan 2 3:04pm" }}"></span>
                        {{ else if $enableOnlineIndicator }}
                          <span class="online-indicator" data-popover-type="text" data-popover-text="Online"></span>
                        {{ end }}
                      </div>
                    </div>
                  </div>
                  <div class="device-info-container">
                    <ul class="list-horizontal-text device-info">
                      <li>{{ .String "os" }}</li>
                      <li>{{ .String "user" }}</li>
                    </ul>
                    <div class="device-ip">
                      {{ .String "addresses.0"}}
                    </div>
                  </div>
                </li>
                {{ end }}
              </ul>
